<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NetRouteAI Dashboard</title>
  <script type="module" src="{{ url_for('static', filename='app.js') }}" defer></script>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <style>
    /* Fade animations */
    @keyframes fadeOut {
      to { opacity: 0; visibility: hidden; }
    }
    .animate-fadeOut {
      animation: fadeOut 1s ease forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .animate-fadeIn {
      animation: fadeIn 2s ease forwards;
    }

    /* Node animation background */
    #nodeCanvas {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: transparent;
      z-index: -1;
    }
    .sidebar-group summary {
      background-color: transparent; /* default */
    }
    .sidebar-group summary:hover {
      background-color: #1f2937; /* gray-800 on hover */
    }
    .sidebar-group[open] summary {
      background-color: transparent; /* keep neutral even when open */
    }
    .sidebar-group[open] .active-parent summary {
      background-color: #1f2937; /* highlight only if desired */
    }
  </style>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/netrouteai-icon.png') }}">
</head>

<body class="bg-gray-900 text-white font-mono overflow-hidden">

  <!-- Intro Splash Screen -->
  <div id="intro" class="fixed inset-0 flex items-center justify-center bg-gray-900 z-50">
    <canvas id="nodeCanvas"></canvas>
    <div class="text-center relative z-10">
      <h1 class="text-5xl md:text-7xl font-bold text-green-400 tracking-widest animate-pulse">
        NetRoute<span class="text-white">AI</span>
      </h1>
      <p class="mt-4 text-gray-400 text-sm md:text-lg tracking-widest animate-fadeIn">
        Optimising Network Paths with AI
      </p>
      <div class="mt-8 w-16 h-1 bg-green-400 mx-auto animate-bounce"></div>
    </div>
  </div>

  <div class="flex h-screen">

    <!-- Sidebar -->
    <div id="sidebar" class="w-64 bg-gray-900 text-white p-4 space-y-3 shadow-lg overflow-y-auto">
      <button id="toggleSidebar" class="flex items-center space-x-2 text-sm text-gray-400 hover:text-white transition">
        <svg id="toggleIcon" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        <span class="toggle-label">Collapse</span>
      </button>

<!-- Sidebar Menu -->
<div class="space-y-2 mt-6">

  <!-- Path Finder -->
  <button class="sidebar-btn group relative w-full flex items-center px-3 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 transition" data-view="path">
    <svg class="h-5 w-5 text-green-400 group-hover:text-green-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
      <path stroke-linecap="round" stroke-linejoin="round" d="M5 19s3-2 7-2 7 2 7 2M12 3l3 6H9l3-6z"/>
    </svg>
    <span class="ml-3 label">Path Finder</span>
  </button>

  <!-- AI Analysis -->
  <button class="sidebar-btn group relative w-full flex items-center px-3 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 transition" data-view="aiAnalysis">
    <svg class="h-5 w-5 text-purple-400 group-hover:text-purple-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
      <path stroke-linecap="round" stroke-linejoin="round" d="M5 8l2 2-2 2-2-2 2-2zm10-4l2.5 3.5L21 8l-3.5 2.5L15 14l-2.5-3.5L9 8l3.5-2.5L15 4zm-3 10l1.5 2L12 19l-1.5-3L9 14l3-0z"/>
    </svg>
    <span class="ml-3 label">AI Analysis</span>
  </button>

  <!-- Topology Group -->
  <details class="sidebar-group">
    <summary class="w-full flex items-center px-3 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 transition group relative cursor-pointer select-none">
      <svg class="h-5 w-5 text-blue-400 group-hover:text-blue-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M7 5a3 3 0 100 6 3 3 0 000-6zm10 0a3 3 0 100 6 3 3 0 000-6zM12 13a3 3 0 100 6 3 3 0 000-6z"/>
        <path d="M9.5 8h5M10.7 11.6l-2.1 1.3M13.3 11.6l2.1 1.3" opacity=".6"/>
      </svg>
      <span class="ml-3 label">Topology</span>
      <svg class="caret ml-auto h-4 w-4 text-gray-400 group-hover:text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
      </svg>
    </summary>

    <!-- Children -->
    <div class="mt-1 ml-2 pl-3 border-l border-gray-700 space-y-1">
      <button class="sidebar-btn group relative w-full flex items-center px-3 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 transition" data-view="realtime">
        <svg class="h-5 w-5 text-blue-400 group-hover:text-blue-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 12h4l2-5 4 10 2-5h6"/>
        </svg>
        <span class="ml-3 label">Real-time</span>
      </button>

      <button class="sidebar-btn group relative w-full flex items-center px-3 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 transition" data-view="predictedLat">
        <svg class="h-5 w-5 text-yellow-400 group-hover:text-yellow-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
          <circle cx="12" cy="12" r="8"/>
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 7v5l3 2"/>
        </svg>
        <span class="ml-3 label">Predict Latency</span>
      </button>

      <button class="sidebar-btn group relative w-full flex items-center px-3 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 transition" data-view="predictedAlarm">
        <svg class="h-5 w-5 text-red-400 group-hover:text-red-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 17H9a4 4 0 01-4-4V9a7 7 0 1114 0v4a4 4 0 01-4 4z"/>
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.5 20a2.5 2.5 0 005 0"/>
        </svg>
        <span class="ml-3 label">Predict Alarm</span>
      </button>
    </div>
  </details>
</div>


      <div class="sidebar-footer mt-10 text-xs text-gray-500 toggle-label">
        <p class="text-center">Â© 2025 NetRouteAI</p>
      </div>
    </div>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col overflow-hidden" id="mainContent">
      <div class="p-3 bg-gray-800 border-b border-gray-700 flex justify-between items-center">
        <h2 class="text-green-400 text-sm font-semibold">Path Finder</h2>
        <div class="flex gap-2">
          <button id="pauseBtn" class="bg-yellow-500 hover:bg-yellow-600 text-xs text-black px-3 py-1 rounded">Pause</button>
          <button id="refreshBtn" class="bg-green-500 hover:bg-green-600 text-xs text-white px-3 py-1 rounded">Refresh</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splash Screen Script -->
  <script>
    // Animated network nodes
    const canvas = document.getElementById('nodeCanvas');
    const ctx = canvas.getContext('2d');
    let nodes = [];
    const nodeCount = 30;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    for (let i = 0; i < nodeCount; i++) {
      nodes.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        dx: (Math.random() - 0.5) * 1,
        dy: (Math.random() - 0.5) * 1,
        radius: Math.random() * 3 + 2
      });
    }

    function drawNodes() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = 'rgba(0,255,100,0.8)';
      ctx.strokeStyle = 'rgba(0,255,100,0.3)';
      ctx.lineWidth = 1;

      // Draw and move nodes
      nodes.forEach((node, i) => {
        ctx.beginPath();
        ctx.arc(node.x, node.y, node.radius, 0, Math.PI * 2);
        ctx.fill();

        // Draw lines between close nodes
        nodes.forEach((other, j) => {
          if (i !== j) {
            const dist = Math.hypot(node.x - other.x, node.y - other.y);
            if (dist < 120) {
              ctx.beginPath();
              ctx.moveTo(node.x, node.y);
              ctx.lineTo(other.x, other.y);
              ctx.stroke();
            }
          }
        });

        node.x += node.dx;
        node.y += node.dy;
        if (node.x < 0 || node.x > canvas.width) node.dx *= -1;
        if (node.y < 0 || node.y > canvas.height) node.dy *= -1;
      });

      requestAnimationFrame(drawNodes);
    }
    drawNodes();

    // Splash fade + auto Path Finder
    document.addEventListener("DOMContentLoaded", () => {
      setTimeout(() => {
        const intro = document.getElementById("intro");
        intro.classList.add("animate-fadeOut");
        setTimeout(() => {
          intro.style.display = "none";
          const defaultBtn = document.querySelector('[data-view="path"]');
          if (defaultBtn) defaultBtn.click();
        }, 1000);
      }, 2500);
    });
    
  </script>
</body>
</html>
